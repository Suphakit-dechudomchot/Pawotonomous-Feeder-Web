<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pawotonomous</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Kanit&display=swap">
    <script src="https://kit.fontawesome.com/8b0b6a29b2.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="notification-area">
        <h1 class="name-head">Pawotonomous</h1>
        <span id="deviceStatusCircle" class="status-circle offline" title="สถานะอุปกรณ์: ออฟไลน์"></span>
        <span id="deviceStatusText" class="status-text offline">ออฟไลน์</span>
        <button id="openNotificationBtn">
            <i class="fa-solid fa-bell"></i>
            <span id="notificationDot" class="notification-dot" style="display:none;"></span>
        </button>
    </div>

    <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold;"></div> 
    <!-- ✅ เพิ่ม div นี้เข้ามา -->

    <!-- ✅ Custom Alert Modal Structure -->
    <div id="customAlertOverlay" class="custom-alert-overlay">
        <div id="customAlertContent" class="custom-alert-content">
            <h3 id="customAlertTitle"></h3>
            <p id="customAlertMessage"></p>
            <button id="customAlertOkButton">ตกลง</button>
        </div>
    </div>

    <!-- ✅ New Notification Toast -->
    <div id="newNotificationToast" class="new-notification-toast">
        <span id="newNotificationToastMessage"></span>
        <button onclick="closeNewNotificationToast()">X</button>
    </div>

    <!-- Notification Modal (ถ้ามี) -->
    <div id="notificationModal" class="notification-modal">
        <div class="notification-modal-content">
            <div class="modal-header">
                <h2>การแจ้งเตือน</h2>
                <button id="closeNotificationBtn" class="close-modal-btn">&times;</button>
            </div>
            <ul id="notificationList" class="notification-list">
                <!-- Notifications will be added here by JavaScript -->
            </ul>
        </div>
    </div>

    <main class="main-container">
        <div class="content-wrapper">
            <div class="settings-section">
                <h2>⚙️ การตั้งค่าระบบ</h2>
                <!-- Existing settings content -->
                <label>โซนเวลา (UTC+/-):
                    <select id="timeZoneOffsetSelect">
                        <!-- Options will be generated by JS -->
                        <option value="">-- เลือกโซนเวลา --</option>
                        <option value="7">UTC+7 (กรุงเทพ, Jakarta)</option>
                        <!-- Add other time zones as needed -->
                        <option value="-12">UTC-12</option>
                        <option value="-11">UTC-11</option>
                        <!-- ... truncated for brevity ... -->
                        <option value="+14">UTC+14</option>
                    </select>
                </label>
                <label>ขนาดขวด:
                    <select id="bottleSizeSelect">
                        <option value="">-- เลือกขนาดขวด --</option>
                        <option value="48">18.9 ลิตร - สูง 48cm</option>
                        <option value="45">15 ลิตร - สูง 45cm</option>
                        <option value="37">12 ลิตร - สูง 37cm</option>
                        <option value="24">10 ลิตร / 600ml - สูง 24cm</option>
                        <option value="32">1.5 ลิตร - สูง 32cm</option>
                        <option value="17">350ml - สูง 17cm</option>
                        <option value="custom">กรอกความสูงเอง</option>
                    </select>
                </label>
                <label id="customBottleHeightLabel" style="display: none;">ความสูงขวดเอง (cm):
                    <input type="number" id="customBottleHeightInput" min="1" step="0.1" placeholder="เช่น 30.5">
                </label>

                <!-- Wi-Fi Settings -->
                <h3>การตั้งค่า Wi-Fi</h3>
                <label>
                    SSID: <input type="text" id="wifiSsidInput" placeholder="ชื่อเครือข่าย Wi-Fi">
                </label>
                <label>
                    PASSWORD: <input type="password" id="wifiPasswordInput" placeholder="รหัสผ่าน Wi-Fi">
                </label>
                <p style="font-size: 0.8em; color: #777;">เวลาที่คุณเปลี่ยนแปลงข้อมูล Wi-Fi หรือตั้งค่าอื่นๆ ระบบจะบันทึกอัตโนมัติ<br>ข้อมูล Wi-Fi จะถูกส่งไปยังอุปกรณ์เมื่ออุปกรณ์เชื่อมต่อออนไลน์ครั้งถัดไป</p>
                <!-- End Wi-Fi Settings -->
            </div>

            <!-- ✅ Main Content Container (ส่วนนี้จะแสดงเสมอ แต่ปุ่มจะ disabled) -->
            <div id="mainContentContainer" class="main-content-container" style="display: block;"> 
                <h2>ตั้งค่ามื้ออาหาร</h2>
                <div id="mealList" class="meal-list">
                    <!-- Meals will be added here by JavaScript -->
                </div>
                <button id="addMealBtn" class="add-meal-button"><i class="fa-solid fa-plus"></i> <span class="button-text">เพิ่มมื้ออาหาร</span></button>
                <button id="pasteBtn" class="paste-meal-button" disabled><i class="fa-solid fa-paste"></i> <span class="button-text">วางมื้อ</span></button>
                <button id="saveMealsBtn" class="save-meals-button"><i class="fa-solid fa-save"></i> <span class="button-text">บันทึกมื้ออาหาร</span></button>

                <div class="action-buttons-group">
                    <button id="feedNowBtn" class="feed-now-button"><i class="fa-solid fa-bowl-food"></i> <span class="button-text">ให้อาหารทันที</span></button>
                    <button id="checkFoodLevelBtn" class="check-food-level-button"><i class="fa-solid fa-scale-balanced"></i> <span class="button-text">เช็คปริมาณอาหาร</span></button>
                    <button id="checkAnimalMovementBtn" class="Check animal movement"><i class="fa-solid fa-paw"></i> <span class="button-text">เช็คการเคลื่อนไหว</span></button>

                    <div class="noise-upload-section">
                        <h3>อัปโหลดเสียงสำหรับเล่นทันที</h3>
                        <label>
                            เลือกเสียง:
                            <input type="file" accept="audio/*" id="makenoiseAudioInput" class="makenoise-audio">
                            <span id="makenoiseAudioStatus" style="color: grey;"></span>
                        </label>
                        <button id="makenoiseBtn">
                            <i class="fa-solid fa-volume-high"></i> <span class="button-text">เล่นเสียงนี้ทันที</span>
                        </button>
                    </div>
                </div>
            </div> <!-- ✅ ปิด div#mainContentContainer -->
        </div>
    </main>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script type="module" src="script.js"></script>
    <script type="module" src="animalCalculator.js"></script>
</body>
</html>